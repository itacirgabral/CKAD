Run the following command to change the context: -

kubectl config use-context cluster2



In this task, we will use the kubectl describe, kubectl get, kubectl set and kubectl scale commands. Here are the steps: -


To check all the deployments in all the namespaces in the cluster2, we would have to run the following command:
kubectl get deployments -A



Inspect all the deployments.



We can see that one of the deployment's names is results-apd and deployed on dashboard-apd namespace. Use the kubectl describe command to get detailed information of that deployment: -
kubectl describe -n dashboard-apd deploy results-apd



The output of the kubectl describe command will provide you with a detailed description of the deployment, including its name, namespace, creation time, labels, replicas, and the Docker image being used.



In the previous command, we can see the container and image name under the Pod Template spec. Use the kubectl set command to update the image of that container as follows:
kubectl set image -n dashboard-apd deploy results-apd results-apd-container=nginx:1.23.3



After running the above command, Kubernetes will automatically update the results-apd-container container with the new image, and create a new replica of the resource with the updated image.
The old replica will be deleted once the new one is up and running.



Now, SSH to the cluster2-controlplane node and use echo command to add this new image to a file at /root/records/new-image-records.txt: -
echo "nginx:1.23.3" > /root/records/new-image-records.txt



If the records directory is absent, use the mkdir command to create this directory.



NOTE: - To exit from any node, type exit on the terminal or press CTRL + D.



Now, run the kubectl scale command to scale the deployment to 4:
kubectl scale deployment -n dashboard-apd results-apd --replicas=4



Cross-verify the scaled deployment by using the kubectl get command:

kubectl get deployments,pods -n dashboard-apd